"use strict";(self.webpackChunkdocusaurus_template=self.webpackChunkdocusaurus_template||[]).push([[43628],{13919:function(e,n,t){function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function a(e){return void 0!==e&&!r(e)}t.d(n,{b:function(){return r},Z:function(){return a}})},44996:function(e,n,t){t.d(n,{C:function(){return o},Z:function(){return i}});var r=t(52263),a=t(13919);function o(){var e=(0,r.Z)().siteConfig,n=(e=void 0===e?{}:e).baseUrl,t=void 0===n?"/":n,o=e.url;return{withBaseUrl:function(e,n){return function(e,n,t,r){var o=void 0===r?{}:r,i=o.forcePrependBaseUrl,s=void 0!==i&&i,l=o.absolute,c=void 0!==l&&l;if(!t)return t;if(t.startsWith("#"))return t;if((0,a.b)(t))return t;if(s)return n+t;var u=t.startsWith(n)?t:n+t.replace(/^\//,"");return c?e+u:u}(o,t,e,n)}}}function i(e,n){return void 0===n&&(n={}),(0,o().withBaseUrl)(e,n)}},58215:function(e,n,t){var r=t(67294);n.Z=function(e){var n=e.children,t=e.hidden,a=e.className;return r.createElement("div",{role:"tabpanel",hidden:t,className:a},n)}},26396:function(e,n,t){t.d(n,{Z:function(){return m}});var r=t(87462),a=t(67294),o=t(72389),i=t(79443);var s=function(){var e=(0,a.useContext)(i.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},l=t(89521),c=t(86010),u="tabItem_1uMI";function d(e){var n,t,r,o=e.lazy,i=e.block,d=e.defaultValue,m=e.values,p=e.groupId,f=e.className,v=a.Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),h=null!=m?m:v.map((function(e){var n=e.props;return{value:n.value,label:n.label}})),g=(0,l.lx)(h,(function(e,n){return e.value===n.value}));if(g.length>0)throw new Error('Docusaurus error: Duplicate values "'+g.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var w=null===d?d:null!=(n=null!=d?d:null==(t=v.find((function(e){return e.props.default})))?void 0:t.props.value)?n:null==(r=v[0])?void 0:r.props.value;if(null!==w&&!h.some((function(e){return e.value===w})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+w+'" but none of its children has the corresponding value. Available values are: '+h.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=s(),b=y.tabGroupChoices,k=y.setTabGroupChoices,T=(0,a.useState)(w),R=T[0],x=T[1],Z=[],N=(0,l.o5)().blockElementScrollPositionUntilNextRender;if(null!=p){var E=b[p];null!=E&&E!==R&&h.some((function(e){return e.value===E}))&&x(E)}var F=function(e){var n=e.currentTarget,t=Z.indexOf(n),r=h[t].value;r!==R&&(N(n),x(r),null!=p&&k(p,r))},S=function(e){var n,t=null;switch(e.key){case"ArrowRight":var r=Z.indexOf(e.currentTarget)+1;t=Z[r]||Z[0];break;case"ArrowLeft":var a=Z.indexOf(e.currentTarget)-1;t=Z[a]||Z[Z.length-1]}null==(n=t)||n.focus()};return a.createElement("div",{className:"tabs-container"},a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,c.Z)("tabs",{"tabs--block":i},f)},h.map((function(e){var n=e.value,t=e.label;return a.createElement("li",{role:"tab",tabIndex:R===n?0:-1,"aria-selected":R===n,className:(0,c.Z)("tabs__item",u,{"tabs__item--active":R===n}),key:n,ref:function(e){return Z.push(e)},onKeyDown:S,onFocus:F,onClick:F},null!=t?t:n)}))),o?(0,a.cloneElement)(v.filter((function(e){return e.props.value===R}))[0],{className:"margin-vert--md"}):a.createElement("div",{className:"margin-vert--md"},v.map((function(e,n){return(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==R})}))))}function m(e){var n=(0,o.Z)();return a.createElement(d,(0,r.Z)({key:String(n)},e))}},79443:function(e,n,t){var r=(0,t(67294).createContext)(void 0);n.Z=r},88821:function(e,n,t){var r=t(67294);n.Z=function(){return r.createElement("div",{className:"admonition admonition-warning alert alert--danger"},r.createElement("div",{className:"admonition-heading"},r.createElement("h5",null,r.createElement("span",{className:"admonition-icon"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},r.createElement("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),r.createElement("div",{className:"admonition-content"},r.createElement("p",null,"Never use API flows to implement Browser applications! Using API flows in Single-Page-Apps as well as server-side apps opens up several potential attack vectors, including Login and other CSRF attacks.")))}},12669:function(e,n,t){var r=t(26396),a=t(58215),o=t(67294),i=t(19055),s=t(52387),l=t(25108),c=function(e){var n=e.item;return n.code?(l.warn(n.code,"asfd"),o.createElement(i.Z,{className:"language-"+n.language,children:n.code})):n.image?o.createElement("img",{src:n.image,alt:n.alt}):n.codeFromRemote?o.createElement(s.Z,{language:n.language,link:n.codeFromRemote.link,src:n.codeFromRemote.src}):o.createElement("span",null,"Unknown item type: $",JSON.stringify(n))};n.Z=function(e){var n=e.items;return o.createElement(r.Z,{defaultValue:Object.keys(n)[0],values:Object.keys(n).map((function(e){return{label:n[e].label,value:e}}))},Object.keys(n).map((function(e){return o.createElement(a.Z,{key:e,value:e},o.createElement(c,{item:n[e]}))})))}},56368:function(e,n,t){t.d(n,{Z:function(){return m}});var r=t(26396),a=t(58215),o=t(67294),i=t(52387),s=t.p+"assets/images/browser-61597c2d37644d2e9a6cd62143a17d19.png",l=t.p+"assets/images/browser-3fffa4ddf3b8dbaa9171845af0b1ace3.png",c=t.p+"assets/images/browser-95c5fd81e495c104256cf0460ebd835a.png",u=t.p+"assets/images/browser-22673e53b8fd2d5b86732105f965b818.png",d=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},m=function(e){var n,t=e.flow;switch(t){case"registration":n=o.createElement("img",{src:c,alt:"User Registration HTML Form"});break;case"login":n=o.createElement("img",{src:s,alt:"User Login HTML Form"});break;case"settings":n=o.createElement("img",{src:l,alt:"Profile Settings HTML Form"});break;case"recovery":n=o.createElement("img",{src:u,alt:"Account Recovery HTML Form"});break;case"verification":n=o.createElement("img",{src:u,alt:"Email Verification HTML Form"})}return o.createElement(r.Z,{defaultValue:"browser",values:[{label:"Browser UI",value:"browser"},{label:"Golang (API Flow)",value:"golang"},{label:"ExpressJS",value:"express"},{label:"ReactJS",value:"react"},{label:"React Native",value:"react-native"}]},o.createElement(a.Z,{value:"browser"},n),o.createElement(a.Z,{value:"express"},o.createElement(i.Z,{lang:"js",link:"https://github.com/ory/kratos-selfservice-ui-node/blob/master/src/routes/"+t+".ts",src:"https://raw.githubusercontent.com/ory/kratos-selfservice-ui-node/master/src/routes/"+t+".ts"}),"The views can be rather simple, as Ory Kratos provides you with all the information you need for rendering the forms. The following examples use Handlebars and a generic form generator to render the Flow:",o.createElement(r.Z,{defaultValue:"view",values:[{label:d(t)+" View",value:"view"},{label:"Generic Form View",value:"generic-form"},{label:"Example Input Form Element",value:"input-form"}]},o.createElement(a.Z,{value:"view"},o.createElement(i.Z,{lang:"handlebars",link:"https://github.com/ory/kratos-selfservice-ui-node/blob/master/views/"+t+".hbs",src:"https://raw.githubusercontent.com/ory/kratos-selfservice-ui-node/master/views/"+t+".hbs"})),o.createElement(a.Z,{value:"generic-form"},o.createElement(i.Z,{lang:"handlebars",link:"https://github.com/ory/kratos-selfservice-ui-node/blob/master/views/partials/ui.hbs",src:"https://raw.githubusercontent.com/ory/kratos-selfservice-ui-node/master/views/partials/ui.hbs"})),o.createElement(a.Z,{value:"input-form"},o.createElement(i.Z,{lang:"handlebars",link:"https://github.com/ory/kratos-selfservice-ui-node/blob/master/views/partials/ui_node_input_default.hbs",src:"https://raw.githubusercontent.com/ory/kratos-selfservice-ui-node/master/views/partials/ui_node_input_default.hbs"}))),"The rest of the form partials can be found"," ",o.createElement("a",{href:"https://github.com/ory/kratos-selfservice-ui-node/tree/master/views/partials"},"here"),"."),o.createElement(a.Z,{value:"react"},"A React example is currently in the making."),o.createElement(a.Z,{value:"golang"},o.createElement(i.Z,{lang:"tsx",link:"https://github.com/ory/kratos/blob/master/examples/go/selfservice/"+t+"/main.go.tsx",src:"https://raw.githubusercontent.com/ory/kratos/master/examples/go/selfservice/"+t+"/main.go"}),"The rest of the code examples partials can be found"," ",o.createElement("a",{href:"https://github.com/ory/kratos/blob/master/examples"},"here")),o.createElement(a.Z,{value:"react-native"},o.createElement(i.Z,{lang:"tsx",link:"https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Routes/"+d(t)+".tsx",src:"https://raw.githubusercontent.com/ory/kratos-selfservice-ui-react-native/master/src/components/Routes/"+d(t)+".tsx"}),"The views can be rather simple, as Ory Kratos provides you with all the information you need for rendering the forms.",o.createElement(r.Z,{defaultValue:"generic-form",values:[{label:"Generic Form View",value:"generic-form"},{label:"Example Input Form Element",value:"input-form"}]},o.createElement(a.Z,{value:"generic-form"},o.createElement(i.Z,{lang:"handlebars",link:"https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Form/Form.tsx",src:"https://raw.githubusercontent.com/ory/kratos-selfservice-ui-react-native/master/src/components/Form/Form.tsx"})),o.createElement(a.Z,{value:"input-form"},o.createElement(i.Z,{lang:"handlebars",link:"https://github.com/ory/kratos-selfservice-ui-react-native/blob/master/src/components/Form/Field.tsxs",src:"https://raw.githubusercontent.com/ory/kratos-selfservice-ui-react-native/master/src/components/Form/Field.tsx"}))),"The rest of the form partials can be found"," ",o.createElement("a",{href:"https://github.com/ory/kratos-selfservice-ui-react-native/tree/master/src"},"here")))}},52387:function(e,n,t){t.d(n,{Z:function(){return u}});var r=t(67294),a=t(83300),o=t.n(a),i=t(19055),s="container_2x1S",l=t(25108),c=function(e,n){if(!e)return 0;var t=n.findIndex((function(n){return n.indexOf(e)>-1}));return-1===t?0:t},u=function(e){var n=e.src,t=e.title,a=(0,r.useState)(""),u=a[0],d=a[1];(0,r.useEffect)((function(){var t,r,a;o()(n.replace("github.com","raw.githubusercontent.com").replace("/blob/","/")).then((function(e){return e.text()})).then((t=e,r=t.startAt,a=t.endAt,function(e){var n=e.split("\n"),t=c(r,n);t>0&&(n=["// ..."].concat(n.slice(t,-1)));var o=c(a,n);return o>0&&(n=[].concat(n.slice(0,o+1),["// ..."])),n.join("\n")})).then(d).catch(l.error)}),[]);var m="language-"+function(e){var n=e.split(".").pop();switch(n){case"jsx":return"jsx";case"tsx":return"tsx";case"ts":return"typescript";case"go":return"go";case"yaml":case"yml":return"yaml";case"js":return"javascript";case"html":return"html";case"pug":return"pug";default:return n}}(n),p='title="'+(t||function(e){var n=e.match(new RegExp("https://github.com/[^/]+/[^/]+/blob/[^/]+/(.+)","i"))||[];return n.length>=2?n[1]:e}(n))+'"';return r.createElement("div",{className:s},r.createElement(i.Z,{metastring:p,className:m,children:u}))}},59079:function(e,n,t){t.d(n,{Z:function(){return m}});var r=t(67294),a=t(57273),o="graph_1lrJ",i="pointer_3d8u",s="overlay_2fuY",l="visible_2Z3U",c="backdrop_2z5L",u=t(94184),d=t.n(u);a.Z.initialize({startOnLoad:!0,logLevel:"fatal",securityLevel:"strict",arrowMarkerAbsolute:!1,theme:"neutral",flowchart:{useMaxWidth:!0,htmlLabels:!0,rankSpacing:65,nodeSpacing:30,curve:"basis"},sequence:{useMaxWidth:!0},gantt:{useMaxWidth:!0}});var m=function(e){var n,t=e.chart,u=(0,r.useState)(!1),m=u[0],p=u[1],f=(0,r.useState)(void 0),v=f[0],h=f[1],g=(0,r.useState)("mermaid-"+Math.random().toString(36).substr(2,-1))[0],w=function(){return p(!m)};return(0,r.useEffect)((function(){a.Z.render(g,t,(function(e){h(e)}))}),[]),r.createElement(r.Fragment,null,r.createElement("div",{onClick:w,className:d()(o,i),dangerouslySetInnerHTML:{__html:v}}),r.createElement("div",{onClick:w,className:d()(s,i,o,(n={},n[l]=m,n))},r.createElement("div",{onClick:function(e){return e.stopPropagation()},className:d()(c,o),dangerouslySetInnerHTML:{__html:v}})))}},19582:function(e,n,t){var r=t(67294),a=t(59079);n.Z=function(e){return r.createElement(a.Z,{chart:(n=e,t=n.flows,o=void 0===t?["login","registration","settings","..."]:t,i=n.interactions,s=void 0===i?['"Log in"','"Sign Up"','"Update Email"',"..."]:i,l=n.success,c=void 0===l?"Perform flow-specific action (e.g. create user, set session cookie, ...)":l,u=o.length>1?"<"+o.join("|")+">":""+o.join("|"),"\nsequenceDiagram\n  participant B as API Client\n  participant K as Ory Kratos\n\n  B->>K: REST GET /self-service/"+u+"/api\n  K--\x3e>K: Create and store new "+o.join(", ")+" flow\n  K->>B: HTTP 200 OK with flow as application/json payload\n  B--\x3e>B: Render form using e.g. Native iOS UI Elements\n  B--\x3e>B: User fills out forms, clicks e.g. "+s+"\n  B->>K: REST POST to e.g. /self-service/"+u+"?flow=...>\n  K--\x3e>K: Validates and processes payload\n  alt Form payload is valid\n    K->>B: "+c+"\n  else Form payload invalid\n    K--\x3e>K: Update and store flow (e.g. add form validation errors)\n    K->>B: Respond with e.g. HTTP 400 Bad Request and updated flow as payload\n    B--\x3e>B: Render form and validation errors using e.g. Native iOS UI Elements\n    B--\x3e>K: Repeat flow with input data, submit, validate, ...\n  end\n")});var n,t,o,i,s,l,c,u}},64923:function(e,n,t){var r=t(67294),a=t(59079);n.Z=function(e){return r.createElement(r.Fragment,null,r.createElement(a.Z,{chart:(n=e,t=n.flows,o=void 0===t?["login","registration","settings","..."]:t,i=n.interactions,s=void 0===i?['"Log in"','"Sign Up"','"Update Email"',"..."]:i,l=n.success,c=void 0===l?"Perform flow-specific action (e.g. create user, set session cookie, ...)":l,u=o.length>1?"<"+o.join("|")+">":""+o.join("|"),"\nsequenceDiagram\n\n  participant B as Browser\n  participant K as Ory Kratos\n  participant A as Flow UI\n\n  B->>K: Follow link to /self-service/"+u+"/browser\n  K--\x3e>K: Create and store new "+o.join(", ")+" flow\n  K->>B: HTTP 302 Found <selfservice.flows."+u+".ui_url>?flow=<flow-id>\n\n  B->>A: Opens <selfservice.flows.<"+o.join("|")+">.ui_url>?flow=<flow-id>\n  A--\x3e>K: Fetches data to render forms using /selfservice/"+u+"/flows?id=<flow-id>\n  B--\x3e>A: Fills out forms, clicks e.g. "+s.join(", ")+"\n  B->>K: Submits form\n  K--\x3e>K: Validates and processes form payloads\n\n  alt Form payload is valid\n    K->>B: "+c+"\n  else Form payload invalid\n    K--\x3e>K: Update and store flow (e.g. add form validation errors)\n    K--\x3e>B: HTTP 302 Found <selfservice.flows."+u+".ui_url>?flow=<flow-id>\n    B->>A: Opens <selfservice.flows."+u+"?flow=<flow-id>\n    A--\x3e>K: Fetches data to render form fields and errors\n    B->>K: Repeat flow with input data, submit, validate, ...\n  end\n")}),r.createElement("p",null,"The ",r.createElement("em",null,"Flow UI")," (",r.createElement("strong",null,"your application!"),') is responsible for rendering the actual Login and Registration HTML Forms. You can of course implement one app for rendering all the Login, Registration, ... screens, and another app (think "Service Oriented Architecture", "Micro-Services" or "Service Mesh") is responsible for rendering your Dashboards, Management Screens, and so on.'));var n,t,o,i,s,l,c,u}},93680:function(e,n,t){t.r(n),t.d(n,{contentTitle:function(){return T},default:function(){return N},frontMatter:function(){return k},metadata:function(){return R},toc:function(){return x}});var r=t(87462),a=t(63366),o=(t(67294),t(3905)),i=t(44996),s=t(59079),l=t(88821),c=t(64923),u=t(19582),d=t(12669),m={curl:{label:"Raw HTTP",language:"shell",code:t(64576).Z},js:{label:"JavaScript SDK",language:"js",code:t(69543).Z},go:{label:"Go SDK",language:"go",code:t(2842).Z}},p={curl:{label:"Raw HTTP",language:"shell",code:t(59270).Z},html:{label:"HTML",language:"html",code:t(56612).Z},jsx:{label:"ReactJS",language:"js",code:t(66981).Z},node:{label:"ExpressJS",language:"html",code:t(8753).Z},angular:{label:"Angular",language:"js",code:t(60349).Z}},f={curl:{label:"Raw HTTP",language:"shell",code:t(26993).Z},js:{label:"Node",language:"js",code:t(23762).Z},go:{label:"Go",language:"go",code:t(83104).Z}},v={browser:{label:"Browser UI",image:t(86221).Z,alt:"Account Recovery HTML Form with validation errors"},missing:{label:"Missing Email",language:"shell",code:t(81967).Z}},h={browser:{label:"Browser UI",image:t(72667).Z,alt:"Account Recovery HTML Form with success message"},missing:{label:"Email Sent",language:"shell",code:t(64773).Z}},g={browser:{label:"Browser UI",image:t(60214).Z,alt:"Account Recovery HTML Form with an invalid challenge"},missing:{label:"Invalid Challenge",language:"shell",code:t(26721).Z}},w={browser:{label:"Browser UI",image:t(83433).Z,alt:"Account Recovery HTML Form with an invalid challenge"},missing:{label:"Update Credentials",language:"shell",code:t(61678).Z}},y=t(56368),b=["components"],k={id:"account-recovery",title:"Account Recovery and Password Reset"},T=void 0,R={unversionedId:"self-service/flows/account-recovery",id:"version-v0.5/self-service/flows/account-recovery",isDocsHomePage:!1,title:"Account Recovery and Password Reset",description:"initBrowserFlow,",source:"@site/versioned_docs/version-v0.5/self-service/flows/account-recovery.mdx",sourceDirName:"self-service/flows",slug:"/self-service/flows/account-recovery",permalink:"/kratos/docs/v0.5/self-service/flows/account-recovery",editUrl:"https://github.com/ory/kratos/edit/master/docs/versioned_docs/version-v0.5/self-service/flows/account-recovery.mdx",tags:[],version:"v0.5",lastUpdatedBy:"David San",lastUpdatedAt:1617653330,formattedLastUpdatedAt:"4/5/2021",frontMatter:{id:"account-recovery",title:"Account Recovery and Password Reset"},sidebar:"version-v0.5/docs",previous:{title:"User Settings and Profile Updates",permalink:"/kratos/docs/v0.5/self-service/flows/user-settings"},next:{title:"Email and Phone Verification and Account Activation",permalink:"/kratos/docs/v0.5/self-service/flows/verify-email-account-activation"}},x=[{value:"Methods",id:"methods",children:[{value:"Recovery <code>link</code> Method",id:"recovery-link-method",children:[],level:3}],level:2},{value:"Initialize Recovery Flow",id:"initialize-recovery-flow",children:[{value:"Recovery for Browser Clients",id:"recovery-for-browser-clients",children:[],level:3},{value:"Recovery for API Clients",id:"recovery-for-api-clients",children:[],level:3}],level:2},{value:"Recovery Flow Payloads",id:"recovery-flow-payloads",children:[{value:"Send Recovery Link to Email",id:"send-recovery-link-to-email",children:[],level:3}],level:2},{value:"Recovery Flow Form Rendering",id:"recovery-flow-form-rendering",children:[],level:2},{value:"Recovery Form Validation",id:"recovery-form-validation",children:[{value:"Recovery Link via Email",id:"recovery-link-via-email",children:[{value:"Successful Submission",id:"successful-submission",children:[],level:4}],level:3}],level:2},{value:"Unsuccessful Recovery",id:"unsuccessful-recovery",children:[],level:2},{value:"Successful Recovery",id:"successful-recovery",children:[],level:2}],Z={toc:x};function N(e){var n=e.components,t=(0,a.Z)(e,b);return(0,o.kt)("wrapper",(0,r.Z)({},Z,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Please read the ",(0,o.kt)("a",{parentName:"p",href:"../../self-service"},"Self-Service Flows")," overview before\ncontinuing with this document."))),(0,o.kt)("p",null,"Account Recovery must be performed if access to an account needs to be\nrecovered. Common use cases include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'"Forgot password" flows'),(0,o.kt)("li",{parentName:"ul"},'"Lost MFA device" flows'),(0,o.kt)("li",{parentName:"ul"},"...")),(0,o.kt)("p",null,"There are two Recovery Flow types supported in ORY Kratos:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Flows where the user sits in front of the Browser (e.g. website, single page\napp, ...)"),(0,o.kt)("li",{parentName:"ul"},"Flows where API interaction is required (e.g. mobile app, Smart TV, ...)")),(0,o.kt)("p",null,"The Recovery Flow can be summarized as the following state machine:"),(0,o.kt)(s.Z,{chart:'\nstateDiagram\n  s1: Flow is initialized\n  s2: User Interface renders Recovery Flow Forms\n  s3: Update Recovery Flow with Error Context(s)\n  s4: Recovery challenge initiated (e.g. link via email)\n  s5: Recovery completed, user logged in\n  [*] --\x3e s1 : User clicks "Recover Account"\n  s1 --\x3e s2\n  s2 --\x3e s4 : User provides valid recovery data\n  s2 --\x3e s3 : User provides invalid recovery data\n  s3 --\x3e s2\n  s4 --\x3e s5 : Challenge response valid\n  s4 --\x3e s3 : Challenge response invalid\n  s5 --\x3e [*]\n',mdxType:"Mermaid"}),(0,o.kt)("p",null,"To enable recovery flows, make the following adjustments to your ORY Kratos\nconfiguration:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="path/to/config/kratos.yml"',title:'"path/to/config/kratos.yml"'},"selfservice:\n  methods:\n    link:\n      enabled: true\n  flows:\n    recovery:\n      enabled: true\n")),(0,o.kt)("h2",{id:"methods"},"Methods"),(0,o.kt)("p",null,"Currently, one recovery method is supported:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"link")," method performs account recovery (also known as password reset) by\nsending an email containing a recovery link to the user.")),(0,o.kt)("h3",{id:"recovery-link-method"},"Recovery ",(0,o.kt)("inlineCode",{parentName:"h3"},"link")," Method"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"link")," method is dis/enabled in the ORY Kratos config:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="path/to/my/kratos/config.yml"',title:'"path/to/my/kratos/config.yml"'},"selfservice:\n  methods:\n    link:\n      enabled: true\n      # ...\n")),(0,o.kt)("p",null,"There are two email types sent by this method:"),(0,o.kt)("p",null,(0,o.kt)("figure",null,(0,o.kt)("img",{alt:"Recovery email sent to unknown address",src:(0,i.Z)("img/docs/mailslurper-recovery-unknown.png")}),(0,o.kt)("figcaption",null,"If the requested email address is an unknown recovery address, an account recovery attempt email is sent to that email address."))),(0,o.kt)("p",null,(0,o.kt)("figure",null,(0,o.kt)("img",{alt:"Recovery email sent to a known recovery address",src:(0,i.Z)("img/docs/mailslurper-recovery-known.png")}),(0,o.kt)("figcaption",null,"If the requested email address is a known recovery address, a recovery link is sent to that email address."))),(0,o.kt)("p",null,"This prevents account enumeration attacks as explained in this\n",(0,o.kt)("a",{parentName:"p",href:"https://www.troyhunt.com/website-enumeration-insanity-how-our-personal-data-is-leaked/"},"brilliant blog post by Troy Hunt"),"."),(0,o.kt)("p",null,"The emails are using templates that can be customised as explained in\n",(0,o.kt)("a",{parentName:"p",href:"/kratos/docs/v0.5/concepts/email-sms#templates"},"Customizing E-Mail Templates"),". The\ntemplate IDs are:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Unknown email address: ",(0,o.kt)("inlineCode",{parentName:"li"},"recovery_invalid")),(0,o.kt)("li",{parentName:"ul"},"Known email address: ",(0,o.kt)("inlineCode",{parentName:"li"},"recovery_valid"))),(0,o.kt)("p",null,"You should also configure how long a session is privileged. The user will only\nbe able to update his/her password (or any other credential) for the specified\namount of time after clicking on the recovery link:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="path/to/kratos/config.yml"',title:'"path/to/kratos/config.yml"'},"selfservice:\n  flows:\n    settings:\n      privileged_session_max_age: 15m\n")),(0,o.kt)("p",null,"To specify that an identity's trait is a recovery email, use the following\nIdentity JSON Schema:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-diff"},' {\n   "$id": "https://schemas.ory.sh/presets/kratos/quickstart/email-password/identity.schema.json",\n   "$schema": "http://json-schema.org/draft-07/schema#",\n   "title": "Person",\n   "type": "object",\n   "properties": {\n     "traits": {\n       "type": "object",\n       "properties": {\n         "email": {\n           "type": "string",\n           "format": "email",\n           "ory.sh/kratos": {\n             "credentials": {\n               "password": {\n                 "identifier": true\n               }\n             },\n+            "recovery": {\n+              "via": "email"\n+            }\n           }\n         }\n       }\n       "additionalProperties": false\n     }\n   }\n }\n')),(0,o.kt)("h2",{id:"initialize-recovery-flow"},"Initialize Recovery Flow"),(0,o.kt)("p",null,"The first step is to initialize the Recovery Flow. This sets up Anti-CSRF tokens\nand more. Each recovery flow has a ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," parameter which follows the state\nmachine:"),(0,o.kt)(s.Z,{chart:"\nstateDiagram-v2\n\t[*] --\x3e choose_method\n\tchoose_method --\x3e sent_email\n\tsent_email --\x3e sent_email\n\tnote right of sent_email\n\t    The user may fill out the email form input again as a way to re-send the email.\n\tend note\n\tsent_email --\x3e passed_challenge\n\tpassed_challenge --\x3e [*]\n",mdxType:"Mermaid"}),(0,o.kt)("p",null,"where"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"choose_method")," indicates that the user has not chosen a recovery method yet.\nThis is useful when ",(0,o.kt)("inlineCode",{parentName:"li"},"link")," is not the only recovery method active."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"sent_email")," implies that the recovery email has been sent out."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"passed_challenge")," is set when the user has clicked the recovery link and\ncompleted the account recovery.")),(0,o.kt)("h3",{id:"recovery-for-browser-clients"},"Recovery for Browser Clients"),(0,o.kt)("p",null,"The Recovery Flow for browser clients relies on HTTP redirects between ORY\nKratos, your Recovery UI, and the end-user's browser:"),(0,o.kt)(c.Z,{flows:["recovery"],success:"Set session cookie and initialize Settings Flow",interactions:['"Recover account"'],mdxType:"SelfServiceBrowserFlow"}),(0,o.kt)("p",null,"To initialize the Recovery Flow, point the Browser to the initialization\nendpoint:"),(0,o.kt)(d.Z,{items:p,mdxType:"CodeTabs"}),(0,o.kt)("p",null,"The server responds with a HTTP 302 redirect to the Recovery UI, appending the\n",(0,o.kt)("inlineCode",{parentName:"p"},"?flow=<flow-id>")," query parameter (see the curl example) to the URL configured\nhere:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="path/to/config/kratos.yml"',title:'"path/to/config/kratos.yml"'},"selfservice:\n  flows:\n    recovery:\n      # becomes http://127.0.0.1:4455/recovery?flow=df607aa1-d555-4b2a-b3e4-0f5a1d2fe6f3\n      ui_url: http://127.0.0.1:4455/recovery\n")),(0,o.kt)("h3",{id:"recovery-for-api-clients"},"Recovery for API Clients"),(0,o.kt)(l.Z,{mdxType:"ApiWarning"}),(0,o.kt)("p",null,"The Recovery Flow for API clients does not use HTTP Redirects and can be\nsummarized as follows:"),(0,o.kt)(u.Z,{flows:["recovery"],success:"Return session token",interactions:['"Recover account"'],mdxType:"SelfServiceApiFlow"}),(0,o.kt)("p",null,"To initialize the API flow, the client calls the API-flow initialization\nendpoint\n(",(0,o.kt)("a",{parentName:"p",href:"/kratos/docs/v0.5/reference/api#initialize-recovery-flow-for-api-clients"},"REST API Reference"),")\nwhich returns a JSON response:"),(0,o.kt)(d.Z,{items:f,mdxType:"CodeTabs"}),(0,o.kt)("h2",{id:"recovery-flow-payloads"},"Recovery Flow Payloads"),(0,o.kt)("p",null,"Fetching the Recovery Flow\n(",(0,o.kt)("a",{parentName:"p",href:"/kratos/docs/v0.5/reference/api#get-recovery-flow"},"REST API Reference"),") is usually\nonly required for browser clients but also works for Recovery Flows initialized\nby API clients. All you need is a valid flow ID:"),(0,o.kt)(d.Z,{items:m,mdxType:"CodeTabs"}),(0,o.kt)("h3",{id:"send-recovery-link-to-email"},"Send Recovery Link to Email"),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The ",(0,o.kt)("inlineCode",{parentName:"p"},"link")," recovery mode will always open a link in the browser, even if it was\ninitiated by an API client. This is because the user clicks the link in his/her\nemail client, which opens the browser."))),(0,o.kt)("p",null,"When the ",(0,o.kt)("inlineCode",{parentName:"p"},"link")," method is enabled, it will be part of the ",(0,o.kt)("inlineCode",{parentName:"p"},"methods")," payload in\nthe Recovery Flow:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},'$ curl -H "Accept: application/json" -s \\\n    \'http://127.0.0.1:4434/self-service/recovery/flows?id=2183a80c-a190-4fde-95bd-a15aa3103930\' | jq -r \'.methods.link.config\'\n\n{\n  "action": "http://127.0.0.1:4433/self-service/recovery/methods/link?flow=2183a80c-a190-4fde-95bd-a15aa3103930",\n  "method": "POST",\n  "fields": [\n    {\n      "name": "csrf_token",\n      "type": "hidden",\n      "required": true,\n      "value": "PsERHvmk+4Ouq3wjMAaLsATrAk7sydJjkSbZFVynvwCJRZRtOTkosFHJQy5p5fFiBv6KnxwP2oSXUvE8J5w9Lw=="\n    },\n    {\n      "name": "email",\n      "type": "email",\n      "required": true\n    }\n  ]\n}\n')),(0,o.kt)("h2",{id:"recovery-flow-form-rendering"},"Recovery Flow Form Rendering"),(0,o.kt)("p",null,"The Recovery User Interface is a route (page / site) in your application\n(server, native app, single page app) that should render a recovery form."),(0,o.kt)("p",null,"In stark contrast to other Identity Systems, ORY Kratos does not render this\nHTML. Instead, you need to implement the HTML code in your application (e.g.\nNodeJS + ExpressJS, Java, PHP, ReactJS, ...), which gives you extreme\nflexibility and customizability in your user interface flows and designs."),(0,o.kt)("p",null,"You will use the Recovery Flow JSON response to render the recovery form UI,\nwhich could looks as follows depending on your programming language and web\nframework:"),(0,o.kt)(y.Z,{flow:"recovery",mdxType:"RenderFlow"}),(0,o.kt)("h2",{id:"recovery-form-validation"},"Recovery Form Validation"),(0,o.kt)("p",null,"The form payloads are then submitted to ORY Kratos which follows up with:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"An HTTP 302 Found redirect pointing to the Recovery UI for Browser Clients."),(0,o.kt)("li",{parentName:"ul"},"An ",(0,o.kt)("inlineCode",{parentName:"li"},"application/json")," response for API Clients.")),(0,o.kt)("h3",{id:"recovery-link-via-email"},"Recovery Link via Email"),(0,o.kt)("p",null,"To send the recovery email, the end-user fills out the form. There might be\nvalidation errors such as a malformed email:"),(0,o.kt)(d.Z,{items:v,mdxType:"CodeTabs"}),(0,o.kt)("p",null,"When validation errors happen, browser clients receive a HTTP 302 Found redirect\nto the Recovery Flow UI, containing the Recovery Flow ID which includes the\nerror payloads."),(0,o.kt)("p",null,"For API Clients, the server typically responds with HTTP 400 Bad Request and the\nRecovery Flow in the response payload as JSON."),(0,o.kt)("h4",{id:"successful-submission"},"Successful Submission"),(0,o.kt)("p",null,"On successful submission, an email will be sent to the provided address:"),(0,o.kt)(d.Z,{items:h,mdxType:"CodeTabs"}),(0,o.kt)("h2",{id:"unsuccessful-recovery"},"Unsuccessful Recovery"),(0,o.kt)("p",null,"If the recovery challenge (e.g. the link in the recovery email) is invalid or\nexpired, the user will be HTTP 302 redirected to the Recovery UI."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"When an invalid or expired challenge is used, ORY Kratos initializes a new\nAccount Recovery flow automatically. This flow will always be a Browser-based\nflow because the challenge is completed by clicking a link!"))),(0,o.kt)("p",null,"The new Recovery Flow includes an error message such as the following:"),(0,o.kt)(d.Z,{items:g,mdxType:"CodeTabs"}),(0,o.kt)("p",null,"Please keep in mind that this part of the flow always involves a Browser!"),(0,o.kt)("h2",{id:"successful-recovery"},"Successful Recovery"),(0,o.kt)("p",null,"Completing account recovery always results in a HTTP 302 redirect with a ORY\nKratos Login Session Cookie to the Settings UI with a Settings Flow prompting\nthe user to update their password or credentials:"),(0,o.kt)(d.Z,{items:w,mdxType:"CodeTabs"}))}N.isMDXComponent=!0},83300:function(e,n){var t=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("unable to locate global object")}();e.exports=n=t.fetch,t.fetch&&(n.default=t.fetch.bind(t)),n.Headers=t.Headers,n.Request=t.Request,n.Response=t.Response},26993:function(e,n){n.Z='$ curl -s -X GET \\\n  -H "Accept: application/json"  \\\n  http://127.0.0.1:4433/self-service/recovery/api | jq\n\n{\n  "id": "2183a80c-a190-4fde-95bd-a15aa3103930",\n  "type": "api",\n  "expires_at": "2020-09-09T07:45:39.1784136Z",\n  "issued_at": "2020-09-09T06:45:39.1784136Z",\n  "request_url": "http://127.0.0.1:4433/self-service/recovery/api",\n  "methods": {\n    // ...\n  },\n  "state": "choose_method"\n}\n'},83104:function(e,n){n.Z='package api\n\nimport (\n  "fmt"\n\n  "github.com/ory/kratos-client-go/client/public"\n  "github.com/ory/kratos-client-go/client"\n)\n\nfunc main() {\n  c := client.NewHTTPClientWithConfig(nil,\n    &client.TransportConfig{Host: "127.0.0.1:4433", BasePath: "/", Schemes: []string{"http"}})\n\n  rs, _ := c.Public.InitializeSelfServiceRecoveryViaAPIFlow(public.\n    NewInitializeSelfServiceRecoveryViaAPIFlowParams())\n\n  fmt.Printf("%+v", rs.Payload)\n}\n'},23762:function(e,n){n.Z="import { Configuration, PublicApi } from '@ory/kratos-client';\nconst kratos = new PublicApi(new Configuration({ basePath: 'http://127.0.0.1:4433/' }));\n\nkratos.initializeSelfServiceRecoveryViaAPIFlow()\n  .then(({ status, data: flow }) => {\n    console.log(flow) // see the Raw HTTP tab for the payload\n  })\n"},59270:function(e,n){n.Z='curl -s -v -X GET \\\n  -H "Accept: text/html"  \\\n  http://127.0.0.1:4433/self-service/recovery/browser\n\n> GET /self-service/recovery/browser HTTP/1.1\n> Host: 127.0.0.1:4433\n> User-Agent: curl/7.64.1\n> Accept: text/html\n>\n< HTTP/1.1 302 Found\n< Cache-Control: 0\n< Content-Type: text/html; charset=utf-8\n< Location: http://127.0.0.1:4455/recovery?flow=df607aa1-d555-4b2a-b3e4-0f5a1d2fe6f3\n< Set-Cookie: csrf_token=y4Ocu6V83BapwJwbPw/pnlRHHw40DZbjq5iuDrxl0Ds=; Path=/; Domain=127.0.0.1; Max-Age=31536000; HttpOnly\n<\n<a href="http://127.0.0.1:4455/recovery?flow=df607aa1-d555-4b2a-b3e4-0f5a1d2fe6f3">Found</a>.\n'},56612:function(e,n){n.Z='<a href="http://127.0.0.1:4433/self-service/recovery/browser">Recover Account</a>\n\n\x3c!-- or --\x3e\n\n<script>\n  const initrecovery = () => {\n    window.location.href = \'http://127.0.0.1:4433/self-service/recovery/browser\'\n  }\n<\/script>\n\n<a onClick="initrecovery">Recover Account</a>\n'},8753:function(e,n){n.Z="express.get('/recovery', function (req, res) {\n  res.redirect(302, 'http://127.0.0.1:4433/self-service/recovery/browser')\n})\n"},66981:function(e,n){n.Z="import React from 'react'\n\nconst MyComponent = () => (\n  <a href=\"http://127.0.0.1:4433/self-service/recovery/browser\">Recover Account</a>\n)\n"},60349:function(e,n){n.Z='<a href="http://127.0.0.1:4433/self-service/recovery/browser">Recover Account</a>\n'},64576:function(e,n){n.Z='$ curl -H "Accept: application/json" -s \\\n    \'http://127.0.0.1:4433/self-service/recovery/flows?id=2183a80c-a190-4fde-95bd-a15aa3103930\' | jq\n\n{\n  "id": "2183a80c-a190-4fde-95bd-a15aa3103930",\n  "type": "api",\n  "expires_at": "2020-09-09T07:45:39.1784136Z",\n  "issued_at": "2020-09-09T06:45:39.1784136Z",\n  "request_url": "http://127.0.0.1:4433/self-service/recovery/api",\n  "methods": {\n    // ...\n  },\n  "state": "choose_method"\n}\n'},2842:function(e,n){n.Z='package samples\n\nimport (\n  "fmt"\n\n  "github.com/ory/kratos-client-go/client/public"\n  "github.com/ory/kratos-client-go/client"\n)\n\nfunc main() {\n  c := client.NewHTTPClientWithConfig(nil,\n    &client.TransportConfig{Host: "127.0.0.1:4433", BasePath: "/", Schemes: []string{"http"}})\n\n  flowID := "" // Usually something like: res.Request.URL.Query().Get("flow")\n\n  rs, err := c.Public.GetSelfServiceRecoveryFlow(\n    common.NewGetSelfServiceRecoveryFlowParams().\n      WithID(flowID),\n  )\n\n  fmt.Printf("%+v", rs.Payload) //\n}\n'},69543:function(e,n){n.Z="import { Configuration, PublicApi } from '@ory/kratos-client';\nconst kratos = new PublicApi(new Configuration({ basePath: 'http://127.0.0.1:4433/' }));\n\nconst flowId = '' // usually something like: req.query.flow\n\nkratos.getSelfServiceRecoveryFlow(flowId)\n  .then(({ status, data: flow, ...response }) => {\n    console.log(flow) // see the Raw HTTP tab for the payload\n  })\n"},26721:function(e,n){n.Z='$ curl -H "Accept: application/json" -s \\\n    \'http://127.0.0.1:4433/self-service/recovery/flows?id=3f1ba761-89dc-4c84-8d13-1c976ab968b2\' | jq\n\n{\n  "id": "3f1ba761-89dc-4c84-8d13-1c976ab968b2",\n  "type": "browser",\n  "expires_at": "2020-09-09T08:17:49.0329601Z",\n  "issued_at": "2020-09-09T07:17:49.0329601Z",\n  "request_url": "http://127.0.0.1:4433/self-service/recovery/methods/link?token=asdf",\n  "messages": [\n    {\n      "id": 4060004,\n      "text": "The recovery token is invalid or has already been used. Please retry the flow.",\n      "type": "error",\n      "context": {}\n    }\n  ],\n  "methods": {\n    "link": {\n      "method": "link",\n      "config": {\n        "action": "http://127.0.0.1:4433/self-service/recovery/methods/link?flow=3f1ba761-89dc-4c84-8d13-1c976ab968b2",\n        "method": "POST",\n        "fields": [\n          {\n            "name": "csrf_token",\n            "type": "hidden",\n            "required": true,\n            "value": "nRmx/wHkAdU5mM+uJ2HwtIqdXSEq0xvSFVoiz6fwfcB0wNcA0C6W2RKnxgGXJe8e1dU1bohF4FACJnr/iaIM1A=="\n          },\n          {\n            "name": "email",\n            "type": "email",\n            "required": true\n          }\n        ]\n      }\n    }\n  },\n  "state": "choose_method"\n}\n'},81967:function(e,n){n.Z='$ curl -H "Accept: application/json" -s \\\n    \'http://127.0.0.1:4433/self-service/verification/flows?id=ba0f508a-f2fb-435d-b5e2-0307db00d75d\' | jq -r \'.methods.link.config\'\n\n{\n  "action": "http://127.0.0.1:4433/self-service/verification/methods/link?flow=ba0f508a-f2fb-435d-b5e2-0307db00d75d",\n  "method": "POST",\n  "fields": [\n    {\n      "name": "csrf_token",\n      "type": "hidden",\n      "required": true,\n      "value": "ZmifOn0KaTicicQ0NServtpnOWPD8pga5gzG028fq/4+Atwx/Yr69v/28O83GeSJB/55PTNxJHCmKW9rWX27VQ=="\n    },\n    {\n      "name": "email",\n      "type": "email",\n      "required": true,\n      "value": "",\n      "messages": [\n        {\n          "id": 4000002,\n          "text": "Property email is missing.",\n          "type": "error",\n          "context": {\n            "property": "email"\n          }\n        }\n      ]\n    }\n  ]\n}\nfoo\n'},64773:function(e,n){n.Z='$ curl -H "Accept: application/json" -s \\\n    \'http://127.0.0.1:4433/self-service/recovery/flows?id=73fcb010-da5c-4eb9-b329-3ed677a6897b\' | jq\n\n{\n  "id": "73fcb010-da5c-4eb9-b329-3ed677a6897b",\n  "type": "browser",\n  "expires_at": "2020-09-09T08:05:45.7589062Z",\n  "issued_at": "2020-09-09T07:05:45.7589062Z",\n  "request_url": "http://127.0.0.1:4433/self-service/recovery/browser",\n  "active": "link",\n  "messages": [\n    {\n      "id": 1060002,\n      "text": "An email containing a recovery link has been sent to the email address you provided.",\n      "type": "info",\n      "context": {}\n    }\n  ],\n  "methods": {\n    "link": {\n      "method": "link",\n      "config": {\n        "action": "http://127.0.0.1:4433/self-service/recovery/methods/link?flow=73fcb010-da5c-4eb9-b329-3ed677a6897b",\n        "method": "POST",\n        "fields": [\n          {\n            "name": "csrf_token",\n            "type": "hidden",\n            "required": true,\n            "value": "LQwF8fph9hU3gzAcrG9ENsg0Ee7Cks+1L5om09nGSqDE1WMOK6thGRy8ObMcK1ucl3x5oWAENDc45n7j95Q7tA=="\n          },\n          {\n            "name": "email",\n            "type": "email",\n            "required": true,\n            "value": "foo@ory.sh"\n          }\n        ]\n      }\n    }\n  },\n  "state": "sent_email"\n}\n'},61678:function(e,n){n.Z='$ curl -s -X GET \\\n  -H "Authorization: Bearer $sessionToken"  \\\n  -H "Accept: application/json"  \\\n  \'http://127.0.0.1:4433/self-service/settings/flows?id=286928b2-3802-480d-82b5-0faeb1433f0a\' | jq\n\n{\n  "id": "286928b2-3802-480d-82b5-0faeb1433f0a",\n  "type": "browser",\n  "expires_at": "2020-09-09T08:23:42.8547952Z",\n  "issued_at": "2020-09-09T07:23:42.8547952Z",\n  "request_url": "http://127.0.0.1:4433/self-service/recovery/methods/link?token=j9YA2ywevoicLl8Oxd1EIWC3T43d2qDh",\n  "messages": [\n    {\n      "id": 1060001,\n      "text": "You successfully recovered your account. Please change your password or set up an alternative login method (e.g. social sign in) within the next 15.00 minutes.",\n      "type": "info",\n      "context": {\n        "privilegedSessionExpiresAt": "2020-09-09T07:38:42.8719856Z"\n      }\n    }\n  ],\n  "methods": {\n    // ...\n  },\n  "identity": {\n    "id": "9f7c079e-bccb-414e-852b-2def6910ea6d",\n    "schema_id": "default",\n    "traits": {\n      "email": "aeneas@ory.sh"\n    }\n  },\n  "state": "show_form"\n}\n'},86221:function(e,n,t){n.Z=t.p+"assets/images/browser-email-missing-69ea020a0cddbff89b491f732b1d2dd1.png"},60214:function(e,n,t){n.Z=t.p+"assets/images/browser-invalid-challenge-65c38ebdbc9abc6aea81dd25f84ba3f5.png"},83433:function(e,n,t){n.Z=t.p+"assets/images/browser-settings-success-c322911a938d0d41e859182da98fc284.png"},72667:function(e,n,t){n.Z=t.p+"assets/images/browser-success-8e227a51ec0b57fdf6e6d165eba4f63b.png"}}]);